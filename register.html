<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="assets/css/register_style.css">
  
  
</head>
<body>

  <p></p>



    
  <div class="center">

    <h1>Register A New Account</h1>

    <p>Enter Email</p>
    <input type="text" id="user"/>

    <p>Create Password</p>
    <input type="password" id="password"/>

    <p style="color: black;" id="confirm_text">Confirm Password</p>
    
    <input type="password" id="password_check" oninput="checkifpasssame()"/> <br/> <br/>

    <input type="button" id = "save" value="Create Account" onclick="send_json()">

    <p id="error"></p>

  </div>
  
  
</body>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

<script>




  function saveStaticDataToFile() {

    if (document.getElementById("confirm_text").value == "Ok!"){

      var username = document.getElementById("user").value;
      var password = document.getElementById("password").value;
      var stdin = username + "\n" + password;
      var text_file = new Blob([stdin], {type:"txt"});
      var anchor = document.createElement("a");
      anchor.href = URL.createObjectURL(text_file);
      anchor.download = "info.txt";
      anchor.click();
    }else{
      document.getElementById("save").innerHTML = "Check Password Match"
    }

    }


  function checkifpasssame() {

    var password = document.getElementById("password").value;
    var current = document.getElementById("password_check").value;

    if (current == password){
      document.getElementById("confirm_text").innerHTML = "Ok!";
      document.getElementById("confirm_text").style.color = 'green';
      document.getElementById("save").disabled = false;
    }else{
      document.getElementById("confirm_text").innerHTML = "Password doesn't match";
      document.getElementById("confirm_text").style.color = 'red';
      document.getElementById("save").disabled = true;
    }
  }


  function fetch_data() {
    var URL = "https://api.github.com/users/Devaaron7"

    fetch(URL)
    .then(results => results.json())
    .then(console.log);
  }

  
  function send_data() {
    var URL = "https://universalclassroom.herokuapp.com/"
    var username = document.getElementById("user").value;
    var password = document.getElementById("password").value;

    fetch(URL, { method: "POST", body: username + ":" + password})
    .then(results => results.json())
    .then(console.log);
  }



  function send_json() {
    var URL = "https://universalclassroom.herokuapp.com/create"
    var username = document.getElementById("user").value;
    var password = document.getElementById("password").value;

    $.ajax({
      type: "POST",
      url: URL,
      data: JSON.stringify({ "userName": username, "password" : password }),
      contentType: "application/json",
      success: function (result) {
        console.log(result);
        if(result == "Account Successfully Created!"){
          document.location.href="register_success.html";
        }else{
          document.location.href="register_fail.html";
        }
      },
      error: function (result, status) {
        console.log(result);
        document.getElementById("error").innerText = 'Error trying to connect';
        document.getElementById("error").style.color = 'red';
      }
    });
      }


  </script> 

</html>